<h5><%= link_to "Back to Waitlists", waitlists_path %></h5>
<h2><%= @waitlist.name %></h2>

<div class="row">
  <div class="span5">
    <h5>Applications</h5>
    <% if (can_edit_my_adopters? || can_edit_all_adopters?) && !@waitlist.new_record? %>
      <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th>Place</th>
            <th>Name</th>
          </tr>
        </thead>
        <tbody id="adopters_table">
          <%= form_for @waitlist, html: { :class => "form-horizontal" } do |f| %>
            <%= f.fields_for :adopter_waitlists do |wa| %>
              <tr>
                <td><%= wa.object.rank %></td>
                <td><%= wa.object.adopter.name %></td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
      <h3>Add Adopter</h3>
      <%= form_with(model:[@waitlist, @waitlist.adopter_waitlists.build], local: true) do |f| %>
        
      <% end %>
    <% else %>
      <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th>Place</th>
            <th>Name</th>
          </tr>
        </thead>
        <tbody id="adopters">
          <% @waitlist.adopter_waitlists.find_each do |wa| %>
            <tr>
              <td><%= wa.rank %></td>
              <td><%= wa.adopter.name %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% end %>
  </div>
</div>

<div class="row">
  <div class="span5">
    <h5>Dogs</h5>
      <% if (can_edit_dogs? || can_add_dogs?) && !@waitlist.new_record? %>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>Dog Id</th>
              <th>Name</th>
            </tr>
          </thead>
          <tbody id="dogs_sort">
            <%= form_for @waitlist, html: { :class => "form-horizontal" } do |f| %>
              <%= f.fields_for :dogs do |d| %>
                <tr>
                  <td><%= d.object.tracking_id %></td>
                  <td><%= d.object.name %></td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
        <h3>Add Dog</h3>
          <div class="control-group">
            <%= form_for @waitlist, html: { :class => "form-horizontal" } do |f| %>
              <%= f.fields_for :dogs do |d| %>
                <%= d.collection_select(:waitlist_id, @dogs, :id, :name, include_blank: '-select-') %><br /><br />
                <%= d.submit "Add Dog", :id => "add_dog_submit", :class => "btn btn-small btn-primary" %>
              <% end %>
            <% end %>
          </div>
      <% else %>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
            <tr>
              <th>Dog Id</th>
              <th>Name</th>
            </tr>
          </thead>
          <tbody id="dogs">
            <% @waitlist.dogs.each do |d| %>
              <tr>
                <td><%= d.tracking_id %></td>
                <td><%= d.name %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      <% end %>
  </div>
</div>
